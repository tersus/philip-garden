<h1> Hello world! </h1>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script src="/static/api/Tersus.js"></script>

<script type="text/javascript">
  function saveText(){
     tersus.writeFile("/Monad.hs",$("#text").val(),function(msg){alert(msg)});
  }
  
  function populateTextArea(content){ $("#text").val(content) }

  function loadText(){
     tersus.getFile("/Monad.hs",populateTextArea);
  }

  $(document).ready(loadText);

  var users = [];
  function addUser(){

      users.push($("#userIn").val());
      $("#userIn").val('');
  }

  function sendDocument(){

      document.tersus.sendMessageAsync(users,document.tersus.application,$("#text").val(),function(m){});
  }

  document.tersus.initMessaging();
  
  document.tersus.registerDefaultCallback(function(msg){

      alert('User: ' + msg.userSender + ', Sent: '+msg.content);
  });
</script>

<p>Welcome to emacs-on-fire, text something to your file in /files/text.txt.</p>

<p>At the moment, only you have access to this file. </p>

<b>Next todo:</b> Share with another user (which implies you are the owner and he has access to modify it).


<hr />

<input type="button" value="Load" onClick="loadText()"/>
<input type="button" value="Save" onClick="saveText()"/>
<input type="button" value="Send" onClick="sendDocument()"/>
<input type="text" id="userIn"/>
<input type="button" value="Add User" onClick="addUser()"/>

<p>
  <textarea id="text" rows="20" cols="120"></textarea>
</p>

<hr />
